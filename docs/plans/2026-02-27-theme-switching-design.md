# Theme Switching Design

## Goal

Enable easy swapping between Hyprland themes (colors + wallpaper) via a CLI command, powered by Nix flake configuration generation and Stylix.

## Themes

Starting set:

- **final-fantasy** (existing custom) — deep navy + ice crystal blues
- **grail** (existing custom) — corporate dark + steel accents
- **dark-oxide** (existing custom) — near-black + bright green/blue
- **catppuccin-mocha** (from `base16-schemes`) — soothing pastels on dark
- **tokyo-night** (from `base16-schemes`) — dark blue/purple neon
- **hyprland-default** (new custom) — cyan-to-green gradient on dark gray, matching Hyprland's autogenerated config

Each theme is a pair: `{ scheme = <base16 yaml>; wallpaper = <image path>; }`.

## Architecture

### 1. Theme Registry (`themes.nix`)

A top-level file that maps theme names to `{ scheme, wallpaper }` attrsets. Custom themes use local YAML files in `modules/stylix/assets/themes/`. Community themes reference `pkgs.base16-schemes`.

### 2. Flake Configuration Generation (`flake.nix`)

`mkHome` accepts a hostname and theme name. The flake generates home configs for every host x theme combination:

- `anthony@atlas` → host's default theme (configurable per host)
- `anthony@atlas-catppuccin-mocha` → explicit theme variant
- `anthony@atlas-tokyo-night` → etc.

Host defaults are defined in a `hostDefaults` attrset mapping hostname to default theme name.

The theme injection adds a module that sets:

- `modules.themes.theme` = scheme
- `modules.themes.wallpaper` = wallpaper
- `modules.hyprpaper.wallpaper` = wallpaper path

### 3. Host Overrides Cleanup

`hosts/*/home-overrides.nix` files stop setting `modules.hyprpaper.wallpaper` and any theme options. They only contain host-specific hardware config (monitors, workspaces, waybar pinning).

### 4. `theme-switch` CLI Script

A `writeShellApplication` derivation with the script in a separate `.sh` file (loaded via `builtins.readFile`). Added to `home.packages`.

Usage:

- `theme-switch` — lists available themes
- `theme-switch catppuccin-mocha` — switches to the named theme

The script runs `nh home switch` targeting the appropriate flake config (`user@hostname-themename`). Stylix handles full reload of all themed applications (waybar, hyprlock, hyprpaper, terminals, GTK) through home-manager activation.

### 5. Hyprland Default Base16 Theme (new file)

Custom base16 YAML capturing Hyprland's autogenerated look:

- Dark gray backgrounds (#111111)
- Cyan (#33ccff) and green (#00ff99) accents from the default border gradient
- Clean, neon-on-dark aesthetic

## Files Changed

| File                                                 | Action        | Description                                     |
| ---------------------------------------------------- | ------------- | ----------------------------------------------- |
| `themes.nix`                                         | Create        | Theme registry                                  |
| `modules/stylix/assets/themes/hyprland_default.yaml` | Create        | Hyprland default base16 scheme                  |
| `flake.nix`                                          | Modify        | Generate host x theme home configs              |
| `modules/hm/tools/theme-switch/default.nix`          | Create        | Nix module for the script                       |
| `modules/hm/tools/theme-switch/theme-switch.sh`      | Create        | Shell script                                    |
| `modules/hm/tools/default.nix`                       | Create/modify | Import theme-switch module                      |
| `hosts/atlas/home-overrides.nix`                     | Modify        | Remove wallpaper/theme settings                 |
| `hosts/tiberius/home-overrides.nix`                  | Modify        | Remove wallpaper/theme settings                 |
| `hosts/lapnix/home-overrides.nix`                    | Modify        | Remove wallpaper/theme settings                 |
| `modules/stylix/default.nix`                         | Modify        | Remove hardcoded defaults (injected from flake) |

## What Stays the Same

- All Hyprland, waybar, hyprlock, mako modules — they already consume Stylix colors
- GTK/cursor theming — Stylix handles propagation
- Monitor/workspace config — stays per-host in home-overrides
- NixOS system configurations — unchanged, theme is home-manager only

## Adding a New Theme

1. Add a wallpaper to `modules/stylix/assets/walls/`
2. Add an entry to `themes.nix` (either custom YAML or `base16-schemes` reference)
3. Rebuild — new `theme-switch <name>` option appears automatically
